{
    "candidates": [
        {
            "content": {
                "parts": [
                    {
                        "text": "```json\n{\n  \"application\": \"SLURM\",\n  \"details\": {\n    \"resource_manager\": \"SLURM\",\n    \"partition\": \"a40x\",\n    \"nodes\": 1,\n    \"tasks_per_node\": 1,\n    \"gpus_per_node\": 4,\n    \"memory\": \"256gb\",\n    \"cpus_per_gpu\": 12,\n    \"job_name\": \"fsdp-multi-node-test\",\n    \"output_file\": \"sbatch_outputs/%x_%j.out\",\n    \"environment\": {\n      \"MASTER_PORT\": 12340,\n      \"WORLD_SIZE\": \"SLURM_JOB_NUM_NODES * SLURM_GPUS_PER_NODE\",\n      \"MASTER_ADDR\": \"first node name from SLURM_JOB_NODELIST\",\n      \"CUDA_HOME\": \"environment variable\",\n      \"FI_EFA_FORK_SAFE\": 1,\n      \"FI_EFA_USE_DEVICE_RDMA\": 1,\n      \"FI_EFA_ENABLE_SHM_TRANSFER\": 0,\n      \"OMPI_MCA_mtl_base_verbose\": 1,\n      \"FI_PROVIDER\": \"efa\",\n      \"NCCL_TREE_THRESHOLD\": 0,\n      \"NCCL_DEBUG\": \"ERROR\",\n      \"NCCL_SOCKET_TIMEOUT\": 600000,\n      \"NCCL_DEBUG_SUBSYS\": \"ALL\",\n      \"TORCH_DISTRIBUTED_DEBUG\": \"INFO\",\n      \"NCCL_IBEXT_DISABLE\": 1,\n      \"NCCL_SOCKET_IFNAME\": \"^docker0,lo\",\n      \"OMPI_MCA_btl\": \"^openib\",\n      \"SHARED_VOLUME_DIR\": \"/weka/home-$(whoami)\",\n      \"GLOBAL_BATCH_SIZE\": 64,\n      \"MAX_BATCH_SIZE\": 8,\n      \"GRAD_ACCUM_STEPS\": 1\n    },\n    \"python_script\": \"train.py\",\n    \"python_venv\": \"fsdp-qlora-py311\",\n    \"cuda_version\": \"11.8\",\n    \"model_name\": \"meta-llama/Llama-2-7b-hf\",\n    \"dataset\": \"dummy\",\n    \"batch_size\": 8,\n    \"context_length\": 512,\n    \"gradient_accumulation_steps\": 1,\n    \"training_type\": \"custom_qlora\",\n    \"gradient_checkpointing\": True,\n    \"activation_cpu_offload\": True,\n    \"cpu_offload\": False,\n    \"logging\": \"stdout\",\n    \"verbosity\": True\n  }\n}\n```"
                    }
                ],
                "role": "model"
            },
            "finish_reason": 1,
            "index": 0,
            "safety_ratings": [
                {
                    "category": 9,
                    "probability": 1,
                    "blocked": false
                },
                {
                    "category": 8,
                    "probability": 1,
                    "blocked": false
                },
                {
                    "category": 7,
                    "probability": 1,
                    "blocked": false
                },
                {
                    "category": 10,
                    "probability": 1,
                    "blocked": false
                }
            ],
            "token_count": 0,
            "grounding_attributions": []
        }
    ],
    "usage_metadata": {
        "prompt_token_count": 957,
        "candidates_token_count": 645,
        "total_token_count": 1602,
        "cached_content_token_count": 0
    }
}