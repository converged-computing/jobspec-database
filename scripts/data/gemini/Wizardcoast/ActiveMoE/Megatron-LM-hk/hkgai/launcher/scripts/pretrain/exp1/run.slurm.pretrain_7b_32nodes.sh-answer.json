{
    "application": "Slurm",
    "details": {
        "job_name": "Megatron-LM",
        "nodes": 32,
        "cpus_per_task": 32,
        "memory": "1024G",
        "docker_image": "registry-intl.cn-hongkong.aliyuncs.com/sixpublic/pytorch:23.10-py3",
        "docker_command": "bash hkgai/launcher/scripts/pretrain/exp1/pretrain.sh",
        "environment_variables": {
            "LOGLEVEL": "INFO",
            "WANDB_API_KEY": "YourOwnWandbAPIKey",
            "MASTER_ADDR": "$head_node_ip",
            "MASTER_PORT": "6000",
            "NODE_RANK": "$SLURM_PROCID",
            "NNODES": "32",
            "GRAD_ACC_STEPS": "1",
            "TASK_ID": "exp1.1",
            "CUDA_DEVICE_MAX_CONNECTIONS": "10",
            "OMP_NUM_THREADS": "10",
            "NVIDIA_VISIBLE_DEVICES": "all",
            "NCCL_SOCKET_IFNAME": "ibp",
            "NCCL_IB_HCA": "mlx5",
            "NCCL_DEBUG_SUBSYS": "ALL",
            "GPUS_PER_NODE": "8"
        },
        "volumes": [
            {
                "host": "$PROJECT_ROOT/Megatron-LM",
                "container": "/workspace/megatron"
            },
            {
                "host": "$PROJECT_ROOT/dataset",
                "container": "/workspace/dataset"
            },
            {
                "host": "/run/mellanox/drivers",
                "container": "/run/mellanox/drivers",
                "mode": "shared"
            },
            {
                "host": "/etc/network",
                "container": "/etc/network"
            },
            {
                "host": "/etc",
                "container": "/host/etc"
            },
            {
                "host": "/lib/udev",
                "container": "/host/lib/udev"
            },
            {
                "host": "$PROJECT_ROOT/checkpoints",
                "container": "/workspace/checkpoints"
            }
        ],
        "resources": {
            "gpus": "all",
            "shm_size": "1024g",
            "ulimit": {
                "memlock": "-1"
            },
            "network": "host",
            "ipc": "host",
            "privileged": true
        }
    }
}