{
    "candidates": [
        {
            "content": {
                "parts": [
                    {
                        "text": "```json\n{\n  \"application\": \"SLURM\",\n  \"details\": {\n    \"job_name\": \"cpt-v2-7b-residual\",\n    \"output_file\": \"logs-cpt/%x-%j.log\",\n    \"error_file\": \"logs-cpt/%x-%j.log\",\n    \"partition\": \"MoE\",\n    \"tasks_per_node\": 1,\n    \"cpus_per_task\": 64,\n    \"memory\": 0,\n    \"nodes\": 2,\n    \"gpus\": 8,\n    \"quota_type\": \"reserved\",\n    \"conda_environment\": \"llama-moe\",\n    \"model_type\": \"llama_moe_residual\",\n    \"tokenizer_path\": \"/mnt/petrelfs/share_data/quxiaoye/models/llama_7B\",\n    \"dataset_dir\": \"/mnt/petrelfs/share_data/quxiaoye/SlimPajama_processed\",\n    \"validation_dir\": \"/mnt/petrelfs/share_data/quxiaoye/data/llama1_7B_val_set_tokenized\",\n    \"learning_rate\": 3e-4,\n    \"final_lr_portion\": 0.1,\n    \"per_device_train_batch_size\": 8,\n    \"per_device_eval_batch_size\": 8,\n    \"gradient_accumulation_steps\": 4,\n    \"block_size\": 4096,\n    \"num_tokens\": \"2*10^11\",\n    \"seed\": 1227,\n    \"deepspeed_config_file\": \"conf/deepspeed/bf16_zero1_default.json\",\n    \"num_selects\": 2,\n    \"data_cache\": \"resources/cache\",\n    \"output_dir\": \"/mnt/petrelfs/share_data/quxiaoye/runs/residual_2_2_14_scale2_112gpus/\",\n    \"pretrained_model\": \"/mnt/petrelfs/share_data/quxiaoye/models/LlamaMoEResidualForCausalLM/Gradient-max-l1_norm-sample-feature_change/llama2_7B-14Select2-2Residuals-688Neurons\",\n    \"comment\": \"llama 2 7B, residual 2, gradient 2/14 | residual learn soft 2.0, moe soft 2.0 | GPU num 16, per-device bs 32, lr 3e-4\",\n    \"software\": [\n      \"SLURM\",\n      \"Anaconda\",\n      \"torchrun\",\n      \"deepspeed\",\n      \"smoe\"\n    ],\n    \"resource_requirements\": [\n      \"CPU (64 cores per task)\",\n      \"GPU (8 per node)\",\n      \"Memory (0 per node)\",\n      \"Network (for distributed training)\",\n      \"Storage (for model, data, and output)\"\n    ]\n  }\n}\n```"
                    }
                ],
                "role": "model"
            },
            "finish_reason": 1,
            "index": 0,
            "safety_ratings": [
                {
                    "category": 9,
                    "probability": 1,
                    "blocked": false
                },
                {
                    "category": 8,
                    "probability": 1,
                    "blocked": false
                },
                {
                    "category": 7,
                    "probability": 1,
                    "blocked": false
                },
                {
                    "category": 10,
                    "probability": 1,
                    "blocked": false
                }
            ],
            "token_count": 0,
            "grounding_attributions": []
        }
    ],
    "usage_metadata": {
        "prompt_token_count": 2720,
        "candidates_token_count": 708,
        "total_token_count": 3428,
        "cached_content_token_count": 0
    }
}