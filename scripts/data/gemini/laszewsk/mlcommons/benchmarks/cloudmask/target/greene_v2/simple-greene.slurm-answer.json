{
    "application": "SLURM",
    "details": {
        "software": [
            "python",
            "cudnn",
            "singularity",
            "gcc",
            "cuda",
            "openmpi",
            "tensorflow"
        ],
        "resources": {
            "nodes": 1,
            "gres": "gpu:v100:1",
            "time": "02:00:00",
            "mem": "64G"
        },
        "libraries": [
            "cloudmesh",
            "seff"
        ],
        "environment_variables": [
            "USER_SCRATCH",
            "PROJECT_DIR",
            "PYTHON_DIR",
            "PROJECT_DATA",
            "CONTAINERDIR",
            "CODE_DIR"
        ],
        "commands": [
            "module load cudnn/8.6.0.163-cuda11",
            "module load singularity",
            "module load  gcc/9.2.0  cuda/11.0.228  openmpi/3.1.6 python/3.8.8",
            "module load singularity tensorflow/2.8.0",
            "source $PYTHON_DIR/bin/activate",
            "which python",
            "nvidia-smi",
            "cd $CODE_DIR",
            "pwd",
            "ls",
            "singularity exec --nv ./cloudmask.sif bash -c \"cd ${CODE_DIR} ; python -c \"import os; os.system('ls')\"",
            "cms gpu watch --gpu=0 --delay=0.5 --dense > outputs/simple-$USER-$SLURM_JOB_ID-gpu0.log &",
            "singularity exec --nv ./cloudmask.sif bash -c \"cd ${CODE_DIR} ; python cloudmask_v2.py --config=config.yaml\"",
            "python cloudmask_v2.py --config=simple-config-greene.yaml",
            "seff $SLURM_JOB_ID"
        ]
    }
}