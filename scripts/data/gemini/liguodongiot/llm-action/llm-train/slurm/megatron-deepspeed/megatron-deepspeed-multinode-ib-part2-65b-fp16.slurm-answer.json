{
    "application": "Slurm",
    "details": {
        "job_name": "megatron-multinode-ib-30b-2",
        "partition": "h800-ib-2",
        "output_log": "log/%j.out",
        "error_log": "log/%j.out",
        "nodes": 8,
        "cores_per_node": 80,
        "gpus_per_node": 8,
        "environment_variables": {
            "NCCL_DEBUG": "info",
            "NCCL_IB_DISABLE": 1,
            "NCCL_SOCKET_IFNAME": "bond0",
            "MASTER_HOST": "obtained from scontrol show hostnames",
            "MASTER_ADDR": "obtained from hostname --ip-address",
            "MASTER_PORT": "calculated from SLURM_JOBID",
            "ENDPOINT_URL": "constructed from MASTER_HOST and MASTER_PORT"
        },
        "singularity_image": "megatron-deepspeed-v4-gcc.sif",
        "working_directory": "/workspace/code/Megatron-DeepSpeed-llama-20230815",
        "bind_mount": "/data/hpc/home/guodong.li/workspace:/workspace:rw",
        "framework": "PyTorch",
        "distributed_training": {
            "framework": "c10d",
            "backend": "nccl",
            "nodes": 8,
            "processes_per_node": 8,
            "tensor_model_parallel_size": 16,
            "pipeline_model_parallel_size": 4
        },
        "model_parameters": {
            "num_layers": 80,
            "hidden_size": 8192,
            "ffn_hidden_size": 22016,
            "num_attention_heads": 64,
            "micro_batch_size": 1,
            "global_batch_size": 8,
            "seq_length": 2048,
            "max_position_embeddings": 2048,
            "train_iters": 1500,
            "save_path": "./tmp-llama-65b",
            "load_path": "./tmp-llama-65b",
            "data_path": "/workspace/data/gpt2-data/my-gpt2_text_document /workspace/data/gpt2-data/my-gpt2-1_text_document",
            "data_impl": "mmap",
            "tokenizer_type": "GPTSentencePieceTokenizer",
            "tokenizer_model": "/workspace/model/llama-tokenizer/tokenizer.model",
            "split": "900,50,50",
            "lr": 0.0003,
            "lr_decay_style": "cosine",
            "min_lr": 3e-05,
            "weight_decay": 0.1,
            "clip_grad": 1,
            "lr_warmup_iters": 500,
            "optimizer": "adam",
            "adam_beta1": 0.9,
            "adam_beta2": 0.95,
            "log_interval": 1,
            "save_interval": 2000,
            "eval_interval": 1000,
            "eval_iters": 10,
            "fp16": true,
            "no_query_key_layer_scaling": true,
            "attention_dropout": 0,
            "hidden_dropout": 0,
            "use_rotary_position_embeddings": true,
            "untie_embeddings_and_output_weights": true,
            "swiglu": true,
            "normalization": "rmsnorm",
            "disable_bias_linear": true,
            "deepspeed_activation_checkpointing": true,
            "zero_stage": 0,
            "deepspeed_config": "./tmp/deepspeed.json"
        }
    }
}