{
    "application": "Slurm",
    "details": {
        "job_name": "run_splitServer_JustAK8",
        "nodes": 1,
        "ntasks": 1,
        "cpus_per_task": 4,
        "time_limit": "05:00:00",
        "output": "splitServer_JustAK8_arrays/out_%A_%a.log",
        "environment": {
            "SCRAM_ARCH": "slc7_amd64_gcc900",
            "CMS_PATH": "~/cms_path",
            "CMSSW_VERSION": "CMSSW_11_3_0",
            "CMSSW_CODE": {
                "sonic-workflows": "CMSSW_12_0_0_pre5/src/sonic-workflows",
                "Configuration/ProcessModifiers/python/allSonicTriton_cff.py": "../Configuration/ProcessModifiers/python/allSonicTriton_cff.py",
                "RecoBTag/ONNXRuntime/python/pfParticleNetAK4_cff.py": "../RecoBTag/ONNXRuntime/python/pfParticleNetAK4_cff.py",
                "run_files_splitServer.py": "./run_files_splitServer.py",
                "step2_PAT_files.py": "./step2_PAT_files.py",
                "file_of_files_2.txt": "./file_of_files.txt"
            }
        },
        "commands": [
            "hostname",
            "echo $1",
            "echo $2",
            "mkdir /tmp/dir_${SLURM_JOB_ID}_${SLURM_PROCID}",
            "cd /tmp/dir_${SLURM_JOB_ID}_${SLURM_PROCID}",
            "pwd",
            "current_epoch=$(date +%s)",
            "echo $current_epoch",
            "target_epoch=$(date -d \"$3\" +%s)",
            "echo $target_epoch",
            "sleep_seconds=$(( $target_epoch - $current_epoch ))",
            "echo $sleep_seconds",
            "sleep $sleep_seconds",
            "export SCRAM_ARCH=slc7_amd64_gcc900",
            "source /cvmfs/cms.cern.ch/cmsset_default.sh",
            "CMS_PATH=~/cms_path",
            "ll $CMS_PATH/SITECONF/local/JobConfig/site-local-config.xml",
            "scram p CMSSW_11_3_0",
            "cd CMSSW_11_3_0",
            "eval `scramv1 runtime -sh`",
            "cd ../",
            "mkdir test_REAL",
            "cd test_REAL",
            "pwd",
            "cp ~/CMSSW_12_0_0_pre5_ttbar_splitServer.tgz .",
            "tar -xf CMSSW_12_0_0_pre5_ttbar_splitServer.tgz",
            "cd CMSSW_12_0_0_pre5/src/sonic-workflows",
            "cp ~/allSonicTriton_cff_JustAK4.py ../Configuration/ProcessModifiers/python/allSonicTriton_cff.py",
            "cp ~/pfParticleNetAK4_NOAK4_cff.py ../RecoBTag/ONNXRuntime/python/pfParticleNetAK4_cff.py",
            "scramv1 b -r ProjectRename",
            "eval `scramv1 runtime -sh`",
            "ln -s /home/wmccorma_mit_edu/local_files/*.root .",
            "cp ~/run_files_splitServer.py .",
            "cp ~/step2_PAT_files.py .",
            "cp ~/file_of_files_2.txt ./file_of_files.txt",
            "cmsRun run_files_splitServer.py address=$1 port=$2 tmi=True threads=4 maxEvents=8",
            "current_epoch2=$(date +%s)",
            "echo $current_epoch2",
            "target_epoch2=$(date -d \"$3\" +%s)",
            "extrasecs=100",
            "target_epoch2=$(( $target_epoch2 + $extrasecs ))",
            "echo $target_epoch2",
            "sleep_seconds2=$(( $target_epoch2 - $current_epoch2 ))",
            "echo $sleep_seconds2",
            "sleep $sleep_seconds2",
            "cmsRun run_files_splitServer.py address=$1 port=$2 tmi=True  threads=4 maxEvents=1000 &> outThroughput.txt",
            "python3.6 ~/throughputFinderTimeDiff.py outThroughput.txt ~/splitServer_JustAK8_arrays/Synchro${SLURM_ARRAY_JOB_ID}.txt",
            "cd /tmp",
            "cd /tmp",
            "rm -rf dir_${SLURM_JOB_ID}_${SLURM_PROCID}"
        ],
        "resources": {
            "software": [
                "Slurm",
                "CMSSW",
                "sonic-workflows",
                "python3.6"
            ],
            "files": [
                "~/cms_path/SITECONF/local/JobConfig/site-local-config.xml",
                "~/CMSSW_12_0_0_pre5_ttbar_splitServer.tgz",
                "~/allSonicTriton_cff_JustAK4.py",
                "~/pfParticleNetAK4_NOAK4_cff.py",
                "~/run_files_splitServer.py",
                "~/step2_PAT_files.py",
                "~/file_of_files_2.txt",
                "~/throughputFinderTimeDiff.py",
                "/home/wmccorma_mit_edu/local_files/*.root"
            ]
        }
    }
}