{
    "application": "slurm",
    "software": [
        "tensorflow",
        "python",
        "nv-nsight-cu-cli"
    ],
    "modules": [
        "tensorflow/gpu-2.2.0-py37"
    ],
    "environment_variables": {
        "PROFILER": "cupy",
        "enable_xla": "noxla",
        "XLA_FLAGS": "--xla_gpu_cuda_data_dir=${CUDA_HOME}",
        "CUDA_DIR": "${CUDA_HOME}",
        "OMP_NUM_THREADS": "(( 40 / ${rankspernode} ))",
        "OMP_PLACES": "threads",
        "OMP_PROC_BIND": "spread",
        "sruncmd": "srun -N ${SLURM_NNODES} -n $(( ${SLURM_NNODES} * ${rankspernode} )) --cpu_bind=cores",
        "run_dir": "$PWD/tf_cnn_kernels_nsight/rnn1d-tf2-noxla/$SLURM_JOBID/",
        "script_dir": "../python",
        "script": "rnn1d_tf2.py",
        "net_params": "16,16,32,16 32,16,32,16, 64,16,32,16 128,16,32,16  16,32,32,16 16,64,32,16 16,128,32,16  16,16,64,16 16,16,128,16  16,16,32,32 16,16,32,64 16,16,32,128 ",
        "metrics": "sm__cycles_elapsed.avg.per_second,\nsm__cycles_elapsed.avg,\nsm__inst_executed_pipe_tensor.sum,\nsm__sass_thread_inst_executed_op_fadd_pred_on.sum,\nsm__sass_thread_inst_executed_op_ffma_pred_on.sum,\nsm__sass_thread_inst_executed_op_fmul_pred_on.sum,\nsm__sass_thread_inst_executed_op_hadd_pred_on.sum,\nsm__sass_thread_inst_executed_op_hfma_pred_on.sum,\nsm__sass_thread_inst_executed_op_hmul_pred_on.sum,\ndram__bytes.sum,\nl1tex__t_sectors_pipe_lsu_mem_local_op_ld.sum,\nl1tex__t_sectors_pipe_lsu_mem_local_op_st.sum,\nl1tex__data_pipe_lsu_wavefronts_mem_shared_op_ld.sum,\nl1tex__data_pipe_lsu_wavefronts_mem_shared_op_st.sum,\nl1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum,\nl1tex__t_sectors_pipe_lsu_mem_global_op_st.sum,\nl1tex__t_set_accesses_pipe_lsu_mem_global_op_atom.sum,\nl1tex__t_set_accesses_pipe_lsu_mem_global_op_red.sum,\nl1tex__t_set_accesses_pipe_tex_mem_surface_op_atom.sum,\nl1tex__t_set_accesses_pipe_tex_mem_surface_op_red.sum,\nlts__t_sectors_op_read.sum,\nlts__t_sectors_op_write.sum,\nlts__t_sectors_op_atom.sum,\nlts__t_sectors_op_red.sum",
        "cells": "lstm",
        "precs": "16 32",
        "num_warmup": 5,
        "num_iter": 1,
        "input_tensor_shape": "$batch\" \"$time\" \"$feature",
        "outputstr": "tf2.fp_${prec}.celltype_${cell}.input_${batch}x${time}x${feature}.nneu_${h_size}",
        "profilestring": "/usr/common/software/cuda/11.0.167/bin/nv-nsight-cu-cli \n                --profile-from-start off --metrics ${metrics} --kernel-base demangled -o \n                ${outputstr}.pass_${ctype}.${enable_xla}"
    },
    "resources": {
        "gres": "gpu:1",
        "cpus_per_task": "(( 40 / ${rankspernode} ))",
        "tasks": "(( ${SLURM_NNODES} * ${rankspernode} ))",
        "ntasks_per_code": "(( ${SLURM_NNODES} * ${rankspernode} ))",
        "gpus": "1",
        "gpus_per_node": "1",
        "exclusive": "true",
        "gpu_type": "cuda",
        "time": "4:00:00",
        "nodes": "${SLURM_NNODES}",
        "gres_flags": "gpu:1"
    },
    "versions": {
        "tensorflow": "2.2.0"
    }
}