{
    "application": "deepspeed",
    "software": [
        "python",
        "mpirun"
    ],
    "modules": [
        "cuda/11.7",
        "cudnn/cuda-11.x/8.9.0",
        "nccl/cuda-11.7/2.14.3",
        "openmpi/4.0.5"
    ],
    "environment_variables": {
        "MASTER_NODE": "(/usr/sbin/ip a show | grep inet | grep 192.168.205 | head -1 | cut -d \" \" -f 6 | cut -d \"/\" -f 1)",
        "MASTER_PORT": "((10000 + ($SLURM_JOBID % 50000)))",
        "model_size": "1.3",
        "num_layers": "24",
        "hidden_size": "2048",
        "num_attn_heads": "16",
        "sequence_length": "2048",
        "global_batch_size": "512",
        "lr": "2.0e-4",
        "min_lr": "1.0e-6",
        "init_std": "0.013",
        "train_tokens_in_billion": "300",
        "train_tokens": "((${train_tokens_in_billion} * 1000 * 1000 * 1000))",
        "train_samples": "((300 * 1000000000 * 2 / ${sequence_length}))",
        "exit_duration": "30000000",
        "lr_warmup_tokens_in_million": "3000",
        "lr_warmup_tokens": "(${lr_warmup_tokens_in_million} * 1000000)",
        "lr_decay_tokens_in_billion": "${train_tokens_in_billion}",
        "lr_decay_tokens": "(${lr_decay_tokens_in_billion} * 1000000000)",
        "lr_decay_style": "cosine",
        "mp_size": "1",
        "pp_size": "1",
        "no_pp": "false",
        "zero_stage": "1",
        "num_gpus_pernode": "4",
        "num_node": "1",
        "num_gpus": "(${num_gpus_pernode} * ${num_node})",
        "dp_size": "(${num_gpus} / ${pp_size} / ${mp_size})",
        "batch_size": "1",
        "log_interval": "1",
        "eval_iters": "10",
        "eval_interval": "100",
        "num_save": "100",
        "estimated_train_iter": "(${train_tokens} / ${sequence_length} / ${global_batch_size})",
        "save_interval": "100",
        "activation_checkpoint": "false",
        "log_optimizer_state": "true",
        "current_time": "$(date \"+%Y.%m.%d_%H.%M.%S\")",
        "host": "${HOSTNAME}",
        "seed": "1234",
        "num_workers": "0",
        "data_path": "dataset/BookCorpusDataset_text_document",
        "vocab_path": "dataset/gpt2-vocab.json",
        "merge_path": "dataset/gpt2-merges.txt",
        "prescale_grad": "true",
        "jobname": "gpt_${model_size}B_tok${train_tokens_in_billion}B",
        "output_home": "outputs",
        "log_path": "${output_home}/log/",
        "checkpoint_path": "${output_home}/checkpoint/${jobname}",
        "tensorboard_dir": "${output_home}/tensorboard/",
        "tensorboard_path": "${tensorboard_dir}${jobname}_${host}_${current_time}",
        "config_json": "scripts/deepspeed/config/ds_config_gbs${global_batch_size}_mbs${batch_size}_log${log_interval}_zero${zero_stage}.json",
        "template_json": "examples_deepspeed/rebase/ds_config_gpt_TEMPLATE.json"
    },
    "resources": {
        "gres": "a100_4",
        "cpus_per_task": null,
        "tasks": null,
        "ntasks_per_code": null,
        "gpus": null,
        "gpus_per_node": "4",
        "cores_per_socket": null,
        "gpus_per_task": null,
        "exclusive": null,
        "cpus_per_gpu": null,
        "gpu_type": "a100",
        "time": "1-00:00:00",
        "ntasks_per_node": null,
        "nodes": "1",
        "memory": null,
        "sockets_per_node": null,
        "ntasks_per_socket": null,
        "mem_per_gpu": null,
        "mem_per_cpu": null,
        "gres_flags": null
    },
    "versions": {}
}